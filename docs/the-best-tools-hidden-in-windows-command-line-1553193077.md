# 隐藏在 Windows 命令行中的最佳工具

> 原文：<https://lifehacker.com/the-best-tools-hidden-in-windows-command-line-1553193077>

虽然在 Windows 中它可能不总是最好的选择，但是有些事情你只能从命令行来做。我们之前已经讨论过一些命令行要点，比如使用 [tracert](https://lifehacker.com/how-to-troubleshoot-a-flaky-internet-connection-5319976) 对易断的互联网连接进行故障排除，以及使用 [recimg](http://lifehacker.com/how-to-create-custom-windows-8-install-and-refresh-disc-1433371693) 创建自定义的 Windows 恢复映像。这里还有一些你可能应该知道的(如果你还不知道的话)。



在本文中，我们使用 Windows 8.1 进行截图和详细描述，但这些工具中的大部分已经存在很长时间了，在 Windows 的以前版本中也可以使用。如果您对它们是否可用或选项是否不同有任何疑问，只需打开命令提示符并键入命令后跟`/?`。这将让您知道该命令是否存在，以及可以使用哪些选项。

此外，其中许多工具要求您以管理员权限运行命令提示符。为此，右键单击命令提示符图标，然后选择以管理员身份运行。更好的方法是，将它固定在开始菜单或任务栏上，右键单击它并选择属性，单击高级按钮，然后选择以管理员身份运行。这样，它每次都会以提升的权限运行。

### 系统文件检查器

当系统文件丢失时，Windows 通常可以检测到并为您替换它，而无需您的任何干预。当它发生时，你通常不会得到通知。但是即使有这种能力，系统文件也可能被破坏，或者错误的应用程序可能安装了错误版本的系统文件。有时，这些问题会被忽视。

Windows 包括命令行工具系统文件检查器，它扫描几千个基本的 Windows 文件，将它们与 Windows 附带的原始版本进行比较，或者根据文件的不同，与通过 Windows Updates 更新的原始版本进行比较。如果系统文件检查器发现不匹配，它将替换原始文件。根据您安装 Windows 的方式，您可能需要也可能不需要安装介质，但通常您不会需要。

要运行该工具，只需在命令提示符下键入`sfc`,后跟一个空格，然后是以下任何常见选项:

*   **/scannow** 。这会立即扫描您的系统，并在必要时替换文件。完成后，如果发现问题，您可能需要重新启动 Windows。
*   **/scanonce** 。这将在您下次重新启动系统时执行扫描。
*   **/scanboot** 。这将安排在每次重新启动系统时执行扫描。
*   **回复**。这将使系统文件检查器返回其默认设置。例如，您可以使用它来关闭/scanboot 选项。

### 检查磁盘

检查磁盘尝试修复文件系统错误，定位坏扇区，并从这些坏扇区恢复可读信息。如果你曾经启动过 Windows，它告诉你它在启动前正在扫描你的硬盘，那就是检查硬盘在工作。当 Windows 检测到某些类型的错误时，它会自行安排扫描。

它需要很长时间来运行，尤其是如果你让它扫描整个硬盘，包括可用空间，所以它不是那种你想定期运行的工具。如果你担心一般的硬盘健康，你应该使用免费的 S.M.A.R.T 检查工具。我个人是[Passmark Disk check](http://www.passmark.com/products/diskcheckup.htm)的粉丝。它读取硬盘本身收集的各种自我监控数据，并让您对硬盘的运行情况有一个很好的了解。

尽管如此，有时硬盘物理上可以继续使用，但偶尔会出现坏扇区和这些坏扇区可能导致的文件损坏。Windows 尽最大努力为您纠正这些问题，而且做得相当不错。但是，如果你曾经注意到某些程序只是拒绝启动，或者当你试图访问特定的文件夹或文件时出现错误，磁盘上的坏扇区可能是罪魁祸首。检查磁盘可以找到那些坏扇区，通常从中恢复数据，然后将这些扇区映射出来，以便 Windows 不再使用它们。

您可以通过在命令提示符下键入`chkdsk`,后跟一个空格，然后键入以下任一选项来运行 Check Disk:

*   **音量**。如果您想检查整个驱动器，只需键入驱动器号。
*   **文件名**。您还可以使用 chkdsk 来检查单个文件或一组文件。
*   **/F** 。使用此选项运行它，让 chkdsk 继续并修复这些错误。
*   **/R** 。该选项强制 chkdsk 定位坏扇区并从中恢复信息。如果 chkdsk 无法锁定磁盘(因为您实际上使用的是 Windows，所以通常无法锁定)，它会在您下次重新启动 Windows 时提示您运行该命令。这是您将用于最彻底扫描的选项，因为运行它也意味着您正在运行/F 选项。

如果您运行 chkdsk 而没有额外的选项，它将只是执行一次扫描，并给你一个报告，实际上没有改变任何东西。因此，您需要指定一个卷或文件名以及其他选项之一来进行修复。这里有一个常见的例子。如果希望 chkdsk 扫描 C:驱动器，定位坏扇区，恢复信息，并映射这些坏扇区，请键入:

```
chkdsk C: /R
```

请注意，有一个图形界面的排序检查磁盘。打开 Windows 资源管理器，右键单击驱动器，然后选择“属性”。在“工具”选项卡上，单击“检查”按钮。这将打开一个提示，让您计划下次重新启动时进行扫描。系统会提示您修复发现的任何错误。这个界面不提供命令行版本提供的任何高级选项，也不允许你扫描单个文件。

* * *

### 用于查看本机的 IP 信息

Ipconfig 允许您查看和使用 TCP/IP 信息。您可以使用它来检查电脑的 IP 地址，让它释放或更新自动分配的 IP 地址，甚至清除本地 DNS 缓存。

要使用它，只需在命令行输入`ipconfig`。该命令本身会显示计算机上每个网络适配器的 IP 地址信息。它可能会显示几种不同的适配器，所以您必须做一些搜索来找到您要找的适配器。根据您的设置，您通常会看到一个无线 LAN 适配器(用于无线连接)和一个以太网适配器(用于有线连接)，可能还有几个隧道、虚拟或 VPN 适配器。它显示的信息包括分配给适配器的 IP 地址、物理(或 MAC)地址、默认网关和子网。

您还可以向 ipconfig 命令添加以下任何选项，方法是键入`ipconfig`，后跟一个空格，然后是选项。

*   **/全部**。此选项显示与单独运行 ipconfig 命令相同的所有信息，以及更多信息，例如适配器是否自动分配了来自 DHCP 服务器的 IP 地址，该地址何时分配，以及何时过期。
*   **/释放**。使用此选项释放所有 DHCP 分配的 IP 地址。请注意，在此之后，您的网络将无法工作，通常您需要使用/renew 命令。
*   **/更新**。使用此选项释放，然后立即尝试更新所有 DHCP 分配的信息。这可能是您最常使用的选项，因为它会强制您的电脑重新连接到路由器或 ISP 的服务器(取决于您的设置)。在排除连接问题时，它非常有用。
*   **/flushdns** 。此选项清除本地 DNS 缓存。DNS 用于将我们使用的更容易被人理解的计算机名和网址(如 www.lifehacker.com)翻译成 IP 地址。缓存是本地存储在您电脑上的 DNS 信息，因此您的电脑不必每次都在 DNS 服务器上查找它。有时，刷新 DNS 缓存可以解决您有网络连接，但无法通过名称访问某些电脑或网站的问题。

### 零

cipher 命令主要用于处理 Windows 中 NTFS 卷上的加密文件夹和文件。坦率地说，如果您正在使用这种类型的加密，您有一个图形界面可以完成您需要的大部分工作，尽管该命令对于以编程方式或通过批处理文件和脚本控制加密很有用。

但是，cipher 确实在命令行中包含了一个选项，您可能会发现它很有用:

```
cipher /W:pathname
```

/W 选项移除卷中未使用部分的数据，有效地擦除删除后可能留在硬盘上的数据。您可以将密码指向整个卷(如 C:)或特定文件夹。您可能已经知道，当您从 Windows 中删除文件时，它们实际上并没有从硬盘中删除。相反，Windows 会将该空间标记为可用新文件覆盖。

请注意，这实际上适用于传统硬盘，而不是固态硬盘。当您从 SSD 中删除文件时，这些文件会立即被删除。

### 司机查询

driverquery 命令生成 Windows 中安装的所有硬件驱动程序的列表。它有助于为您提供一份关于已安装驱动程序的报告，您可以保存该报告供以后参考，或者调查当前已安装驱动程序的版本号，以便您在考虑更新时做出更好的决定。

由它自己键入，`driverquery`只是生成一个你可以滚动浏览的驱动列表。像往常一样，这种能力来自您可以添加的选项:

*   **/s** 。此选项允许您指定远程计算机的名称或 IP 地址，以便您调查它已安装的驱动程序。
*   **/si** 。此选项显示驱动程序的数字签名信息。
*   **/fo** 。这确实是您将在 driverquery 中使用的关键选项。它允许您指定显示信息的格式，以便您可以更有效地将其保存为报告。键入/fo 后，添加以下选项之一:TABLE(默认视图)、LIST(依次列出每个驱动程序及其所有信息)和 CSV(以逗号分隔的值显示数据)。

要保存报告，您只需将信息传输到一个文件中，而不是显示在屏幕上。为此，在命令末尾添加`filename.extension`。下面是使用该命令最有用的方法的一个例子:

```
driverquery /fo CSV > drivers.csv
```

这将查询所有驱动程序，将结果格式化为逗号分隔值，然后将它们保存到名为 drivers.csv 的文件中。然后，您可以将该 csv 文件导入 Excel 或其他电子表格程序，以查看所有已安装驱动程序的格式良好的报告。

显然，在命令提示符下有更多的命令可供您使用。我们甚至没有涵盖本文中命令可用的每一个选项，只是我们认为您可能会发现有用的东西。如果您想在 Windows 命令行中探索更多可用的东西，最好的办法就是从源代码开始。微软 TechNet 有完整的 [命令行参考 A-Z](http://technet.microsoft.com/en-us/library/bb490890.aspx) 等着你。

*<small>照片由</small>* [*<small>暗淡迪米奇</small>*](http://www.shutterstock.com/pic.mhtml?id=103503035&src=id)*<small>(Shutterstock)</small>*。